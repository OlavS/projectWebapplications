@{
    ViewBag.Title = "AdminFrontPage";
}
@model Model.ViewModels.AdminFrontPageVM

@section viewtitle {
    <h2>AdminFrontPage</h2>
    }

<div class="container">
    <div class="row">
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="adminFrontContainer">
                <a href="/Admin/AllUsers" class="adminCard" id="users">
                    <h3>Brukere</h3>
                    <p>@Model.UserCount</p>
                </a>
            </div>
        </div>
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="adminFrontContainer">
                <a href="/Admin/ListAllFilms" class="adminCard" id="films">
                    <h3>Filmer</h3>
                    <p>@Model.FilmCount</p>
                </a>
            </div>
        </div>
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="adminFrontContainer">
                <a href="/Admin/AllOrders" class="adminCard" id="orders">
                    <h3>Ordre</h3>
                    <p>@Model.OrdersCount</p>
                </a>
            </div>
        </div>
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="adminFrontContainer">
                <a href="/Admin/AllchangeLogs" class="adminCard" id="changelog">
                    <h3>Endringer</h3>
                    <p>@Model.ChangeCount</p>
                </a>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="adminFrontContainer">
                <h3>Velkommen til:</h3>
                <h1>Holbergs Film Administrasjon</h1>
                <p>
                    <br />
                    <h5>README for obligatorisk oppgave 2 i faget WebApplikasjoner</h5><br />
                    <h6>INNHOLD:</h6>
                    -- 1. URL for løsning på nett.<br />
                    <br />
                    -- 2. Påloggingsinformasjon for admin-bruker.<br />
                    <br />
                    -- 3. Gjenbruk av kode fra forrige oppgave.<br />
                    <br />
                    -- 4. Endringslogg.<br />
                    <br />
                    -- 5. Sletting i database.<br />
                    <br />
                    -- 6. Feilmeldinger.<br />
                    <br />
                    -- 7. Readme fra oppgave 1.<br />
                    <hr />
                    <br />
                    <h6>1.1 URL FOR LØSNING PÅ NETT:</h6>
                    URL:https://holbergsfilm-2.azurewebsites.net/ <br />
                    MERK: Azure-url’en vil forsvinne i løpet av 25.11.2018 da vi kun får tilgang til trial accounts hos Microsoft/Azure.<br />
                    <br />
                    <h6>1.2 DateTime behandling:</h6>
                    Local viser to timer bak på tid. Azure-Server viser riktig.
                    Samme løsning som Oblig 1. Se pkt 7.<br />
                    <hr />
                    <br />
                    <h6>2.1 PÅLOGGINGSINFORMASJON FOR ADMIN-BRUKER:</h6>
                    URL:https://holbergsfilm-2.azurewebsites.net/ <br />
                    <br />
                    Epostadresse: admin@holbergs.no<br />
                    Passord: admadm<br />
                    <br />
                    Ved innlogging vil en bruker som er en administrator omdirigeres til administrasjonsgrensesnittet.<br />
                    En administrator har etter innlogging mulighet til å gå til nettbutikkens hovedside, og tilbake via lenker i<br />
                    brukerens dropdownmeny (øverst til høyre).<br />
                    <br />
                    <h6>2.2 Autorisasjon for administratorsider:</h6>
                    For å hindre tilgang til administrasjon uten adminrettigheter har vi lagt til en sjekk på at man både er logget inn og <br />
                    har en administratorbruker i relevante “ActionResults”.
                    <hr />
                    <br />
                    <h6>3. GJENBRUK AV KODE FRA FORRIGE OPPGAVE:</h6>
                    Vi har valgt å lagdele også hele løsningen fra første oppgave for å forenkle gjenbruk av metoder. Store deler av koden er<br />
                    refaktorert for å fungere i forhold til ”dependency injection”.<br />
                    Noe av denne gamle koden er enhetstestet som følge av at koden er gjenbrukt, men gammel kode som ikke brukes<br />
                    i løsningen av nåværende oppgave er ikke enhetstestet.<br />
                    <br />
                    All controller-kode for denne oppgaven (oppgave 2) er i controlleren “AdminController”, og all denne koden er testet<br />
                    i henhold til oppgaveteksten. Vi har valgt å gjøre det slik for å synliggjøre hvilken kode som hører til denne oppgaven.<br />
                    Vi har endret navn på prosjektet og solution men nameSpacet heter forsåvidt enda oblig1.
                    <hr />
                    <br />
                    <h6>4. ENDRINGSLOGG:</h6>
                    Vi har overridet context.savechanges() til å registrere endringer av tabeller og da lagre disse i endringstabellen. <br />
                    Vi registrerer også når nye elementer blir lagt til i databasen.<br />
                    <hr />
                    <br />
                    <h6>5. SLETTING I DATABASE:</h6>
                    Vi har valgt å aldri slette fra databasen, men setter heller en bool active til  å være false for å deaktivere filmer, brukere osv.<br />
                    <hr />
                    <br />
                    <h6> 6. FEILMELDINGER:</h6>
                    Vi har implementert error håndtering av databasekall-feil. Der det kastes et DatabaseErrorException og gis en melding i web interfacet.<br /> 
                    Samtidig lagrer vi feilemeldinger i error.txt og i en errortabell i databasen.<br/>
                    <hr />
                    <hr />
                    <br />
                    <br />
                    <br />
                    <br />
                    <br />
                    <hr />
                    <br />
                    <h6>7. README FRA OBLIG1</h6>
                    URL TIL LØSNINGEN PÅ NETT (i Azure sin sky):<br />
                    https://holbergsfilm.azurewebsites.net/<br />
                    <br />
                    MERKNADER TIL VÅR LØSNING:<br />
                    <br />
                    Validering:<br />
                    Vi validerer de fleste input-felter på serversiden.<br />
                    Ett unntak er at epostadressen som fylles ut i registreringsformen testes dynamisk opp mot<br />
                    databasen når brukeren har fylt den ut. Finnes den i databasen fra før vises det en melding til<br />
                    brukeren.<br />
                    <br />
                    Postnummer og poststed:<br />
                    Vi går ut ifra at kunden skriver inn riktig informasjon i postnummer og poststedsfeltene.<br />
                    Informasjon lagres til databasens poststedstabell basert på denne informasjonen.<br />
                    Vi har valgt å ikke legge en komplett poststedstabell med alle landets poststeder i databasen.
                    <br />
                    DateTime behandling:<br />
                    Når vi lagrer datetime i tabeller, i dette tilfellet Ordretabellen, så lagrer vi dem "raw".<br />
                    Det innebærer at det er serveren applikasjonen kjøres fra som bestemmer tiden. Dermed blir det<br />
                    UTC tidsformat på Azure sin server som brukes. Dette omgjøres til vår tidsone (+2 timer) når vi<br />
                    henter tiden ut for å vise ordretabbellen. Dette medføerer fremvisningen av tid er feil ved<br />
                    lokal kjøring (i IIS Express), men altså riktig for vår løsning på nett.<br />
                    Se DBHandler.OrdreHandler.AllekundensOrdre.<br />
                    <br />
                    Språk i Kode:<br />
                    Da oppgaven er gitt på norsk, og det er spesifisert at språket på nettsiden skal være norsk,<br />
                    har vi valgt å skrive koden på norsk. Vi har prøvd å holde "engelsk-norsk" til et minimum men<br />
                    ser likevel nå at det vil være hensiktsmessig å gå over til engelsk kode før neste del av<br />
                    oppgaven. (Og da refaktorere all eksisterende kode.)<br />
                    <br />
                    Ubrukt kode:<br />
                    Det er noe kode som ikke er i bruk, men som er der for eventuell senere bruk ved neste<br />
                    obligatoriske oppgave. Det er kommentarer som beskriver dette der det<br />
                </p>
            </div>
        </div>
    </div>
</div>